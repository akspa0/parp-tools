<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WoW Rollback Viewer</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Sidebar overlay -->
    <button id="sidebarToggle" class="hamburger">
        <span></span>
        <span></span>
        <span></span>
    </button>

    <div id="sidebar" class="sidebar">
        <h2>WoW Version Comparison</h2>
        <div id="comparisonInfo" class="info-section"></div>
        
        <div class="control-group">
            <label for="versionSelect">Version:</label>
            <select id="versionSelect"></select>
        </div>
        
        <div class="control-group">
            <label for="mapSelect">Map:</label>
            <select id="mapSelect"></select>
        </div>
        
        <div class="control-group">
            <label>
                <input type="checkbox" id="showObjects" checked> Show Objects
            </label>
        </div>

        <div class="control-group">
            <label style="display:block; margin-bottom:4px;">Object Types:</label>
            <label style="display:block;"><input type="checkbox" id="showWmo" checked> WMO (orange)</label>
            <label style="display:block;"><input type="checkbox" id="showM2" checked> M2/MDX (cyan)</label>
            <label style="display:block;"><input type="checkbox" id="showOther" checked> Other (green)</label>
            <label style="display:block; margin-top:6px;"><input type="checkbox" id="showAdjacentRefs" checked> Show adjacent refs</label>
        </div>

        <!-- Pixel XY debug controls removed: flips/swaps now handled at generation time -->

        <div class="info-section">
            <strong>Last Click:</strong><br>
            Tile: <span id="clickedTile">Click a tile</span><br>
            Coord: <span id="clickedCoord">-</span>
            <h3>Legend</h3>
            <div class="legend-item">
                <span class="color-box" style="background: #4CAF50;"></span>
                <span>Available in selected version</span>
            </div>
            <div class="legend-item">
                <span class="color-box" style="background: #9E9E9E;"></span>
                <span>Not available in selected version</span>
            </div>
            <div class="legend-item">
                <span class="color-box" style="background: #FF9800; width: 10px; height: 10px; border-radius: 50%;"></span>
                <span>WMO placement</span>
            </div>
            <div class="legend-item">
                <span class="color-box" style="background: #00E5FF; width: 8px; height: 8px; border-radius: 50%;"></span>
                <span>M2/MDX placement</span>
            </div>
            <div class="legend-item">
                <span class="color-box" style="background: #4CAF50; width: 6px; height: 6px; border-radius: 50%;"></span>
                <span>Other placement</span>
            </div>
            <div class="legend-item">
                <span class="color-box" style="background: #FF9800; opacity: 0.35; width: 10px; height: 10px; border-radius: 50%;"></span>
                <span>Adjacent reference</span>
            </div>
            <div class="legend-item" style="margin-top:6px;">
                <span>Markers: </span>
                <span id="markerShown">0</span>
                <span>/</span>
                <span id="markerTotal">0</span>
                <span style="margin-left:6px; color:#9E9E9E;">(+<span id="markerAdj">0</span> adj)</span>
            </div>
        </div>
    </div>

    <!-- Full-page Leaflet map -->
    <div id="map"></div>
    
    <!-- Mini-map overview (picture-in-picture) -->
    <canvas id="overviewCanvas" class="overview-canvas"></canvas>
    
    <!-- Sedimentary Layers Panel -->
    <div id="layersPanel" class="layers-panel">
        <div class="layers-header">
            <h3>Sedimentary Layers</h3>
            <button id="layersPanelToggle" class="panel-toggle">âˆ’</button>
        </div>
        <div class="layers-content">
            <div class="layers-filter">
                <input type="text" id="layersSearch" placeholder="Filter by UniqueID range...">
            </div>
            <div id="layersList" class="layers-list">
                <!--Layers will be populated dynamically -->
            </div>
        </div>
    </div>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script type="module">
        import { init } from './js/main.js';
        init();
    </script>
</body>
</html>
